<script>
    import { onMount } from "svelte";
    import {goalData, stingerBool} from "./socketio.js";
    import { panelData } from "./socketio.js";
    import { resize_to_fit } from "./resizeToFit.js";
    import { isReplay } from "./socketio.js";
    import { isInGame } from "./socketio.js";
    var isMounted = false;
    onMount(() => {
        isMounted = true;
        console.log("replay card loaded");
    });
    $: {
        if($goalData?.scorer && isMounted){
        setTimeout(() => {
            console.log("testscorer")
            document.getElementById("replay-scorer").style.fontSize = "33px";
            resize_to_fit(document.getElementById("replay-scorer"), 170);
            console.log("testscorer")
        }, 500)
        }
        if($goalData?.assister && isMounted){
            console.log("testassister")
            document.getElementById("replay-assister").style.fontSize = "30px";
            resize_to_fit(document.getElementById("replay-assister"), 170);
        }
    }
    
</script>

<main>
    <div
    id="outer-replay"
    class="outer-replay"
    style="opacity: {!$isInGame
        ? 0
        : $isReplay && !$stingerBool
        ? 1
        : 0}; transition: opacity .5s;"
    >
    <svg xmlns="http://www.w3.org/2000/svg" transform="translate(10 , 845)" xmlns:xlink="http://www.w3.org/1999/xlink" width="586" height="111" viewBox="0 0 585.85 111.48">
        <defs>
          <linearGradient id="replay-bg-gradient" data-name="New Gradient Swatch 2" y1="55.74" x2="585.85" y2="55.74" gradientUnits="userSpaceOnUse">
            <stop offset="0" stop-color="{$goalData?.team == 0 ? $panelData.blueColor : $goalData?.team == 1 ? $panelData.orngColor : "#ffffff00"}"/>
            <stop offset="1" stop-color="{$goalData?.team == 0 ? $panelData.blueColor2 : $goalData?.team == 1 ? $panelData.orngColor2 : "#ffffff00"}"/>
          </linearGradient>
        </defs>
        <g id="Layer_2" data-name="Layer 2">
          <g id="replay-card">
            <polygon id="replay-bg" points="52.59 4.95 0 76.36 453.87 76.36 506.54 5.05 52.59 4.95" style="fill: url(#replay-bg-gradient)"/>
            <g class="olds">
                <path id="goals-icon" transform="translate(-200, {$goalData?.assister == "" ? 22 : 8}) scale(.7)" style="fill:{$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#000" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#000"}" d="M408.55,39.38,397.74,28.93,402,25.32l-4.22-3.7,4.89-7.06-8.65.77,3.5-13.44-9.68,9.58-3.7-5.14-3.71,5.09-9.27-8.5,3.09,12.52-5.72.51,2.06,5.61-13.75,3.76L370.24,29l-3.34,6.23,7.15.1L368.7,51.89l11.74-12.82,3.71,12.68L387.85,39l6.44,3.81-.36-7.57ZM381.79,29.23h4.29a.94.94,0,0,1,.71.36l.66.91a.87.87,0,0,1,.12.78l-1.24,3.83a.88.88,0,0,1-.83.6h-3.13a.88.88,0,0,1-.83-.6l-1.24-3.83a.87.87,0,0,1,.12-.78l.66-.91a.9.9,0,0,1,.71-.36Zm-1.7-5.12a.65.65,0,0,1,.24-.73L383.55,21a.65.65,0,0,1,.77,0l3.22,2.34a.64.64,0,0,1,.23.73l-1.23,3.79a.65.65,0,0,1-.62.45h-4a.65.65,0,0,1-.62-.45Zm7.3,5.06a.88.88,0,0,1-.13-.78l1.31-4a.83.83,0,0,1,.56-.56l1-.34a.89.89,0,0,1,.79.13l3.18,2.31a.88.88,0,0,1,.32,1l-.95,2.91a.86.86,0,0,1-.82.6h-3.93a.89.89,0,0,1-.71-.36Zm7.37,2.66a.24.24,0,0,1-.33.07.22.22,0,0,1-.1-.13l-.29-.91a.2.2,0,0,1,0-.15l1.39-4.27a.2.2,0,0,1,.08-.12l.78-.56a.23.23,0,0,1,.33,0,.3.3,0,0,1,.05.15,12.74,12.74,0,0,1-1.91,5.87Zm-.66-13.77a.86.86,0,0,1,.75.42,12.55,12.55,0,0,1,1.8,5.52.88.88,0,0,1-.36.78l-.66.5a.89.89,0,0,1-1,0l-3-2.15a.88.88,0,0,1-.31-1l1.13-3.49a.87.87,0,0,1,.83-.6Zm-5.38-4.75a12.8,12.8,0,0,1,5,3.62.24.24,0,0,1,0,.33.2.2,0,0,1-.15.06h-1a.28.28,0,0,1-.13,0l-3.64-2.65a.27.27,0,0,1-.09-.12l-.29-.92a.24.24,0,0,1,.16-.29A.26.26,0,0,1,388.72,13.31Zm.09,2.32,2.48,1.8a.86.86,0,0,1,.31,1l-1.22,3.75a.87.87,0,0,1-.56.56l-1,.33a.84.84,0,0,1-.78-.12l-3.41-2.48a.87.87,0,0,1-.36-.7V18.65a.9.9,0,0,1,.36-.71l3.19-2.31A.87.87,0,0,1,388.81,15.63ZM380.14,14l.26-.79a.86.86,0,0,1,.62-.58,12.71,12.71,0,0,1,5.82,0,.86.86,0,0,1,.63.58l.26.79a.88.88,0,0,1-.32,1l-3,2.16a.89.89,0,0,1-1,0l-3-2.16a.87.87,0,0,1-.32-1Zm3,3.93a.9.9,0,0,1,.36.71v1.09a.88.88,0,0,1-.36.71l-3.4,2.47a.89.89,0,0,1-.79.13l-1-.34a.87.87,0,0,1-.56-.56l-1.22-3.74a.87.87,0,0,1,.32-1l2.47-1.8a.85.85,0,0,1,1,0Zm-9-1a12.8,12.8,0,0,1,5-3.62.24.24,0,0,1,.31.13.22.22,0,0,1,0,.16l-.29.92a.27.27,0,0,1-.09.12l-3.63,2.64a.24.24,0,0,1-.14,0h-1a.24.24,0,0,1-.25-.22.24.24,0,0,1,.07-.18ZM371.22,24a12.55,12.55,0,0,1,1.8-5.52.84.84,0,0,1,.75-.42h.82a.87.87,0,0,1,.83.6l1.13,3.48a.88.88,0,0,1-.31,1l-3,2.16a.89.89,0,0,1-1,0l-.67-.49A.86.86,0,0,1,371.22,24Zm2.61,6.86-.29.92a.24.24,0,0,1-.3.15.26.26,0,0,1-.13-.1A12.74,12.74,0,0,1,371.2,26a.24.24,0,0,1,.38-.21l.77.57a.19.19,0,0,1,.09.11l1.39,4.28A.17.17,0,0,1,373.83,30.86Zm-.41-4a.87.87,0,0,1,.32-1l3.18-2.32a.87.87,0,0,1,.78-.12l1,.34a.83.83,0,0,1,.56.56l1.31,4a.89.89,0,0,1-.13.79l-.64.88a.87.87,0,0,1-.7.36H375.2a.86.86,0,0,1-.83-.6Zm7.08,9.31-.67.49a.87.87,0,0,1-.85.1,12.79,12.79,0,0,1-4.7-3.43.88.88,0,0,1-.17-.84l.26-.78a.86.86,0,0,1,.83-.6h3.66a.88.88,0,0,1,.83.6l1.14,3.49a.89.89,0,0,1-.33,1ZM387,37.47a12.67,12.67,0,0,1-6.18,0,.24.24,0,0,1-.17-.29.2.2,0,0,1,.09-.13l.78-.57a.23.23,0,0,1,.14,0h4.49a.23.23,0,0,1,.14,0l.78.57a.23.23,0,0,1,.06.33.24.24,0,0,1-.13.09Zm6.57-4.11a12.87,12.87,0,0,1-4.7,3.43.86.86,0,0,1-.85-.1l-.67-.49a.86.86,0,0,1-.32-1l1.13-3.48a.88.88,0,0,1,.83-.61h3.66a.88.88,0,0,1,.83.61l.25.78A.86.86,0,0,1,393.59,33.36Z"/>
                <path id="assists-icon" transform="translate(-210, 44) scale(.6)" style="opacity: {$goalData?.assister == "" ? 0 : 1}; fill: {$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#000" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#000"}" d="M455.08,45.62a.29.29,0,0,1-.41,0,.3.3,0,0,1,0-.33,12.51,12.51,0,0,0,.8-1.79,8.42,8.42,0,0,1,2.06-3.28,27.46,27.46,0,0,1,6.69-4.82,1.74,1.74,0,0,0,.72-1.25,2,2,0,0,0-.4-1.3,1.74,1.74,0,0,0-2.56-.39l-4.84,3.61a1,1,0,0,1-1,.17,1.22,1.22,0,0,1-.66-1c0-.26-.11-.8,3.94-11.71,2-5.34,4-10.61,4-10.66a1.47,1.47,0,0,0-.88-2,1.66,1.66,0,0,0-1.14,0,1.5,1.5,0,0,0-.85.91l-5.34,14a1.49,1.49,0,0,1-2.78-1.07l7.1-18.5a1.45,1.45,0,0,0-.88-2,1.45,1.45,0,0,0-2,.87l-6.07,15.8a.69.69,0,0,1-.89.39.7.7,0,0,1-.4-.39l-.82-2.15a.72.72,0,0,1,0-.5l4.33-11.27A1.54,1.54,0,0,0,450,5.82l-2.52,6.64a.7.7,0,0,1-.9.39.68.68,0,0,1-.39-.39l-.39-1a.6.6,0,0,1,0-.49L448,5.05a3.57,3.57,0,0,1,3.36-2.37,3.9,3.9,0,0,1,3.15,1.64,1.74,1.74,0,0,1,.11.18l.09-.22A3.56,3.56,0,0,1,458,1.92a3.91,3.91,0,0,1,3.15,1.64,3.57,3.57,0,0,1,.35,3.35L460.8,8.8a3.62,3.62,0,0,1,1.13-.19,3.88,3.88,0,0,1,3.15,1.65,3.59,3.59,0,0,1,.34,3.36c-2.68,7-5.54,14.66-6.95,18.77l2.19-1.64a3.94,3.94,0,0,1,2.38-.82,4.11,4.11,0,0,1,3.8,2.84,3.82,3.82,0,0,1-1.42,4.36l-.11.08-.12.07a29.58,29.58,0,0,0-8.73,7.07Zm-35.52-8c10.84,5.54,11.14,14.27,21.86,14.27,7.94,0,14.5-8.29,12.68-13.9L442.83,8.38a2.13,2.13,0,0,0-4,1.53l4.5,11.72a1,1,0,1,1-1.77.68L435.29,5.92a2.14,2.14,0,0,0-4,1.53l6.28,16.39a1,1,0,0,1-1.89.72L428.23,5.1a2.14,2.14,0,0,0-4,1.53l7.48,19.46c.45,1.18-1.5,1.93-2,.75l-5.63-14.69a2.14,2.14,0,0,0-4,1.53s8.51,22.15,8.35,23.28c-.09.68-.48.86-.89.55l-5.09-3.8C419.91,31.77,417,35.72,419.56,37.65Z"/>
                <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 308.67 243.74"
                            x="40"
                            y="23"
                        >
                            <g
                                id="goalspeed-svg"
                                style="fill: {$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#000" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#000"}; transform: scale(.4);"
                            >
                                <path
                                    d="M168.2,103.28,181.72,134a5.51,5.51,0,0,0,5.6,3.26l33.36-3.38a5.5,5.5,0,0,0,4.82-4.31l7.1-32.77A5.49,5.49,0,0,0,230,90.83L201,74a5.49,5.49,0,0,0-6.45.65L169.54,97a5.51,5.51,0,0,0-1.37,6.33Z"
                                />
                                <path
                                    d="M124.31,60.79,136.75,89a7.34,7.34,0,0,1-1.83,8.45l-23,20.55a7.33,7.33,0,0,1-8.6.87l-6-3.51a7.37,7.37,0,0,1-3.66-6.2A106.73,106.73,0,0,1,104,61.25a7.33,7.33,0,0,1,5.88-4.11l6.91-.7a7.36,7.36,0,0,1,7.49,4.35Z"
                                />
                                <path
                                    d="M171,152.65l4.62-7.93a7.35,7.35,0,0,0,.37-6.66L161.7,105.58a7.3,7.3,0,0,0-5.17-4.22l-9-2a7.36,7.36,0,0,0-6.45,1.71l-24.74,22.1a7.37,7.37,0,0,0-1.83,8.45l10.4,23.59a7.37,7.37,0,0,0,7.47,4.35l33-3.34A7.38,7.38,0,0,0,171,152.65Z"
                                />
                                <path
                                    d="M229.5,189.56l7.07-32.64a7.38,7.38,0,0,0-1.7-6.46l-6.18-6.91a7.39,7.39,0,0,0-6.22-2.42l-35.53,3.61a7.34,7.34,0,0,0-5.61,3.62l-4.66,8a7.32,7.32,0,0,0-.38,6.66l13.47,30.56a7.34,7.34,0,0,0,7.47,4.35l25.84-2.61a7.37,7.37,0,0,0,6.45-5.76Z"
                                />
                                <path
                                    d="M198.61,53.42l.92,9.13a7.37,7.37,0,0,0,3.62,5.62L233.82,86a7.35,7.35,0,0,0,6.66.37l8.4-3.7a7.36,7.36,0,0,0,4.22-5.17l7-32.42a7.36,7.36,0,0,0-3.49-7.91l-22.27-13a7.35,7.35,0,0,0-8.6.87L201,47.2A7.36,7.36,0,0,0,198.61,53.42Z"
                                />
                                <path
                                    d="M306.81,87.6A106.63,106.63,0,0,0,287,42.74a7.31,7.31,0,0,0-6.59-2.85l-6.91.7a7.34,7.34,0,0,0-6.45,5.76L260.52,76.5A7.37,7.37,0,0,0,264,84.41l26.65,15.52a7.38,7.38,0,0,0,8.61-.87l5.2-4.65a7.35,7.35,0,0,0,2.34-6.81Z"
                                />
                                <path
                                    d="M285.35,139l5.45-25.2a7.34,7.34,0,0,0-3.48-7.91L258.65,89.22a7.32,7.32,0,0,0-6.66-.38l-8.4,3.7a7.36,7.36,0,0,0-4.22,5.17l-7.51,34.69a7.35,7.35,0,0,0,1.7,6.46l6.12,6.84a7.39,7.39,0,0,0,6.22,2.42l33-3.34a7.38,7.38,0,0,0,6.45-5.76Z"
                                />
                                <path
                                    d="M130.2,58.27l13.37,30.35a7.38,7.38,0,0,0,5.18,4.22l9,1.94a7.35,7.35,0,0,0,6.46-1.7l26.47-23.65a7.35,7.35,0,0,0,2.41-6.22l-.92-9.13a7.34,7.34,0,0,0-3.62-5.61l-28.7-16.73a7.36,7.36,0,0,0-8.6.87L132,49.82A7.33,7.33,0,0,0,130.2,58.27Z"
                                />
                                <path
                                    d="M279.56,151.27l-30.69,3.1a7.35,7.35,0,0,0-6.45,5.76l-6.53,30.15a7.34,7.34,0,0,0,3.49,7.91l6,3.51a7.35,7.35,0,0,0,7.21.12,108.14,108.14,0,0,0,36.52-32.71,7.34,7.34,0,0,0,.69-7.16l-2.8-6.34a7.34,7.34,0,0,0-7.44-4.35Z"
                                />
                                <path
                                    d="M176.63,208.67l5.2-4.65a7.34,7.34,0,0,0,1.83-8.45l-12.44-28.23a7.37,7.37,0,0,0-7.47-4.35l-30.69,3.11a7.33,7.33,0,0,0-6.44,5.76l-1.47,6.76a7.33,7.33,0,0,0,2.11,6.88,108.16,108.16,0,0,0,42.34,24.73,7.36,7.36,0,0,0,7-1.57Z"
                                />
                                <path
                                    d="M220.71,5.22A7.32,7.32,0,0,0,215,.89a107.89,107.89,0,0,0-48.79,4.94,7.37,7.37,0,0,0-4.75,5.39L160,18.06A7.37,7.37,0,0,0,163.49,26l26.65,15.52a7.36,7.36,0,0,0,8.6-.87l23-20.55a7.34,7.34,0,0,0,1.83-8.45Z"
                                />
                                <path
                                    d="M305.29,102.81l-6.05,5.41a2,2,0,0,0-.62,1.06l-8,37a2,2,0,0,0,.13,1.22l3.26,7.4a2,2,0,0,0,3.61.09,107,107,0,0,0,11-50.76,2,2,0,0,0-2.07-1.93A2,2,0,0,0,305.29,102.81Z"
                                />
                                <path
                                    d="M237.87,205.55l-7-4.09a2,2,0,0,0-1.2-.26L192,205a2,2,0,0,0-1.13.5l-6.06,5.42a2,2,0,0,0,1,3.46,108.07,108.07,0,0,0,51.73-5.24,2,2,0,0,0,1.19-2.57A2,2,0,0,0,237.87,205.55Z"
                                />
                                <path
                                    d="M121.24,163.43,106,128.79a2,2,0,0,0-.82-.92l-7-4.09a2,2,0,0,0-2.74.68,2,2,0,0,0-.26,1.38,107,107,0,0,0,21,47.52,2,2,0,0,0,2.81.32,2,2,0,0,0,.71-1.13l1.71-7.9A2,2,0,0,0,121.24,163.43Z"
                                />
                                <path
                                    d="M228.82,7.05l3.28,7.42a1.93,1.93,0,0,0,.82.92l32.71,19.06a2,2,0,0,0,1.2.26l8-.81a2,2,0,0,0,1.78-2.2,2,2,0,0,0-.58-1.21A107.83,107.83,0,0,0,231.2,4.33a2,2,0,0,0-2.38,2.72Z"
                                />
                                <path
                                    d="M123.29,48.86l28.23-25.23a2,2,0,0,0,.62-1.06l1.72-7.93a2,2,0,0,0-1.55-2.36,2,2,0,0,0-1.31.17,108,108,0,0,0-38.68,34.61,2,2,0,0,0,.55,2.77,2,2,0,0,0,1.31.33l8-.81A1.94,1.94,0,0,0,123.29,48.86Z"
                                />
                                <path
                                    d="M89.21,126.43C71,143.49,38.68,168.63,0,188.44c36.4-30.29,72.23-58.63,87.6-81.63C87.64,114.43,87.89,121.61,89.21,126.43Z"
                                />
                                <path
                                    d="M92.67,141c-16.61,18-52,45.33-87.67,71.4,36.33-23.76,72.82-38.57,95.71-52A113.65,113.65,0,0,1,92.67,141Z"
                                />
                                <path
                                    d="M106.15,169.66c-23.09,13.13-54.28,37.83-93.34,57.86,41.56-18.64,84.12-36.41,107.63-41.31C115.87,180.34,109.62,174.49,106.15,169.66Z"
                                />
                                <path
                                    d="M130.79,196.46c-23.7,7.12-62.44,23-99.61,47.28,43.64-16.37,88.69-33.13,117.9-35.49A115.68,115.68,0,0,1,130.79,196.46Z"
                                />
                            </g>
                        </svg>
                <text id="replay-scorer" dominant-baseline="middle" transform="translate(90, {$goalData?.assister == "" ? 41 : 25})" style="font-size: 33px;fill: {$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#fff" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#fff"};font-family: IntegralCF-Regular, Integral CF">{$goalData?.scorer ?? ""}</text>
                <text id="replay-assister" dominant-baseline="middle" transform="translate(85 60)" style="font-size: 30px;fill: {$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#fff" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#fff"};font-family: IntegralCF-Regular, Integral CF; opacity: {$goalData?.assister == "" ? 0 : 1}">{$goalData?.assister ?? ""}</text>
                <text id="replay-goalspeed" transform="translate(325 53)" style="font-size: 30px; fill: {$goalData?.team == 0 ? $panelData.blueOverride != "" ? $panelData.blueOverride : "#fff" : $panelData.orngOverride != "" ? $panelData.orngOverride : "#fff"};font-family:IntegralCF-Regular, Integral CF">{$goalData?.speed ?? ""}</text>
            </g>
          </g>
        </g>
      </svg>
      
    </div>
</main>

<style>
    .olds {
        scale: .01;
        top: -5px;
        left: 100px;
    }
</style>
